<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hook Mechanism | Semo</title>
    <meta name="description" content="A command line tool for building enterprise-level Node.js project command line systems">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.ByOUu36n.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DYSJWAPS.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.BnQQ2TOv.js">
    <link rel="modulepreload" href="/assets/chunks/framework.CLl-42Ke.js">
    <link rel="modulepreload" href="/assets/guide_hook_index.md.CJGUZVtA.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-054441f3><!--[--><!--]--><!--[--><span tabindex="-1" data-v-73f28450></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-73f28450>Skip to content</a><!--]--><!----><header class="VPNav" data-v-054441f3 data-v-09a04794><div class="VPNavBar" data-v-09a04794 data-v-c4a1298d><div class="wrapper" data-v-c4a1298d><div class="container" data-v-c4a1298d><div class="title" data-v-c4a1298d><div class="VPNavBarTitle has-sidebar" data-v-c4a1298d data-v-0131d6c8><a class="title" href="/" data-v-0131d6c8><!--[--><!--]--><!----><span data-v-0131d6c8>Semo</span><!--[--><!--]--></a></div></div><div class="content" data-v-c4a1298d><div class="content-body" data-v-c4a1298d><!--[--><!--]--><div class="VPNavBarSearch search" data-v-c4a1298d><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-c4a1298d data-v-8d26dfc3><span id="main-nav-aria-label" class="visually-hidden" data-v-8d26dfc3> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-8d26dfc3 data-v-451dcf82><!--[--><span data-v-451dcf82>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guide/" tabindex="0" data-v-8d26dfc3 data-v-451dcf82><!--[--><span data-v-451dcf82>Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/usage/" tabindex="0" data-v-8d26dfc3 data-v-451dcf82><!--[--><span data-v-451dcf82>Usage</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="http://semo.js.org/typedoc/" target="_blank" rel="noreferrer" tabindex="0" data-v-8d26dfc3 data-v-451dcf82><!--[--><span data-v-451dcf82>Reference</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-c4a1298d data-v-591373de data-v-bb92d1f3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-bb92d1f3><span class="text" data-v-bb92d1f3><span class="vpi-languages option-icon" data-v-bb92d1f3></span><!----><span class="vpi-chevron-down text-icon" data-v-bb92d1f3></span></span></button><div class="menu" data-v-bb92d1f3><div class="VPMenu" data-v-bb92d1f3 data-v-e9e52b5c><!----><!--[--><!--[--><div class="items" data-v-591373de><p class="title" data-v-591373de>English</p><!--[--><div class="VPMenuLink" data-v-591373de data-v-59978ace><a class="VPLink link" href="/cn/guide/hook/" data-v-59978ace><!--[--><span data-v-59978ace>中文</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-c4a1298d data-v-c299e825><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-c299e825 data-v-bd66d326 data-v-db39ca25><span class="check" data-v-db39ca25><span class="icon" data-v-db39ca25><!--[--><span class="vpi-sun sun" data-v-bd66d326></span><span class="vpi-moon moon" data-v-bd66d326></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-c4a1298d data-v-c42e36b4 data-v-bb92d1f3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bb92d1f3><span class="vpi-more-horizontal icon" data-v-bb92d1f3></span></button><div class="menu" data-v-bb92d1f3><div class="VPMenu" data-v-bb92d1f3 data-v-e9e52b5c><!----><!--[--><!--[--><div class="group translations" data-v-c42e36b4><p class="trans-title" data-v-c42e36b4>English</p><!--[--><div class="VPMenuLink" data-v-c42e36b4 data-v-59978ace><a class="VPLink link" href="/cn/guide/hook/" data-v-59978ace><!--[--><span data-v-59978ace>中文</span><!--]--></a></div><!--]--></div><div class="group" data-v-c42e36b4><div class="item appearance" data-v-c42e36b4><p class="label" data-v-c42e36b4>Appearance</p><div class="appearance-action" data-v-c42e36b4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-c42e36b4 data-v-bd66d326 data-v-db39ca25><span class="check" data-v-db39ca25><span class="icon" data-v-db39ca25><!--[--><span class="vpi-sun sun" data-v-bd66d326></span><span class="vpi-moon moon" data-v-bd66d326></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-c4a1298d data-v-c4df3eb3><span class="container" data-v-c4df3eb3><span class="top" data-v-c4df3eb3></span><span class="middle" data-v-c4df3eb3></span><span class="bottom" data-v-c4df3eb3></span></span></button></div></div></div></div><div class="divider" data-v-c4a1298d><div class="divider-line" data-v-c4a1298d></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-054441f3 data-v-4f94df82><div class="container" data-v-4f94df82><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-4f94df82><span class="vpi-align-left menu-icon" data-v-4f94df82></span><span class="menu-text" data-v-4f94df82>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-4f94df82 data-v-313193e8><button data-v-313193e8>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-054441f3 data-v-45e9486e><div class="curtain" data-v-45e9486e></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-45e9486e><span class="visually-hidden" id="sidebar-aria-label" data-v-45e9486e> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-e890d5c5><section class="VPSidebarItem level-0 collapsible has-active" data-v-e890d5c5 data-v-bcc3b12b><div class="item" role="button" tabindex="0" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><h2 class="text" data-v-bcc3b12b>Guide</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bcc3b12b><span class="vpi-chevron-right caret-icon" data-v-bcc3b12b></span></div></div><div class="items" data-v-bcc3b12b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/guide/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Introduction</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/guide/quickstart/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Quick Start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/guide/core-commands/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Core Commands</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/guide/custom-commands/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Custom Commands</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/guide/config/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Configuration Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/guide/hook/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Hook Mechanism</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/guide/plugin/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Plugin Development</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-e890d5c5><section class="VPSidebarItem level-0 collapsible" data-v-e890d5c5 data-v-bcc3b12b><div class="item" role="button" tabindex="0" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><h2 class="text" data-v-bcc3b12b>Usage</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bcc3b12b><span class="vpi-chevron-right caret-icon" data-v-bcc3b12b></span></div></div><div class="items" data-v-bcc3b12b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/usage/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/usage/plugin/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/usage/integration/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Project Integration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/usage/solution/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Solutions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/usage/distribution/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Distribution</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-e890d5c5><section class="VPSidebarItem level-0 collapsible" data-v-e890d5c5 data-v-bcc3b12b><div class="item" role="button" tabindex="0" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><h2 class="text" data-v-bcc3b12b>Community</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bcc3b12b><span class="vpi-chevron-right caret-icon" data-v-bcc3b12b></span></div></div><div class="items" data-v-bcc3b12b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/community/contrib/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>How to Contribute</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bcc3b12b data-v-bcc3b12b><div class="item" data-v-bcc3b12b><div class="indicator" data-v-bcc3b12b></div><a class="VPLink link link" href="/community/qa/" data-v-bcc3b12b><!--[--><p class="text" data-v-bcc3b12b>Frequently Asked Questions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-054441f3 data-v-7a6de58c><div class="VPDoc has-sidebar has-aside" data-v-7a6de58c data-v-2fac68a6><!--[--><!--]--><div class="container" data-v-2fac68a6><div class="aside" data-v-2fac68a6><div class="aside-curtain" data-v-2fac68a6></div><div class="aside-container" data-v-2fac68a6><div class="aside-content" data-v-2fac68a6><div class="VPDocAside" data-v-2fac68a6 data-v-65ace98d><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-65ace98d data-v-c95a813a><div class="content" data-v-c95a813a><div class="outline-marker" data-v-c95a813a></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-c95a813a>On this page</div><ul class="VPDocOutlineItem root" data-v-c95a813a data-v-0e70bbf5><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-65ace98d></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-2fac68a6><div class="content-container" data-v-2fac68a6><!--[--><!--]--><main class="main" data-v-2fac68a6><div style="position:relative;" class="vp-doc _guide_hook_" data-v-2fac68a6><div><h1 id="hook-mechanism" tabindex="-1">Hook Mechanism <a class="header-anchor" href="#hook-mechanism" aria-label="Permalink to &quot;Hook Mechanism&quot;">​</a></h1><p>As a low-level command-line development framework, having a plugin system is essential, especially for a framework like <code>Semo</code> which itself doesn&#39;t directly provide business value. In addition to providing users with mechanisms for plugin scanning, command extension, and configuration management, the hook mechanism significantly enhances flexibility and extensibility, forming a part of the <code>Semo</code> plugin system.</p><p>The concept of hooks is actually easy to understand and ubiquitous, for example, Windows startup programs. When the startup process reaches a certain stage, it needs to check if other applications need to start together at this point in time. Achieving this effect certainly requires configuration; for systems like Windows, this can be configured in the registry or configuration files.</p><p><code>Semo</code>&#39;s hook mechanism uses conventions for dynamic identification. Each plugin&#39;s hooks are determined whether to trigger during command execution, thus incurring performance overhead related to disk I/O and traversal. However, considering that command-line execution logic is generally not overly complex, this is currently considered sufficient. If complex hook call chains emerge later, optimization can be considered. Optimization typically involves converting dynamic to static or using caching to improve speed.</p><h2 id="hook-definition" tabindex="-1">Hook Definition <a class="header-anchor" href="#hook-definition" aria-label="Permalink to &quot;Hook Definition&quot;">​</a></h2><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Define a hook_bar hook</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hookData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argv.$core.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">invokeHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;semo-plugin-foo:hook_bar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;group&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Starting from <code>v1.0.0</code>, hook invocation requires specifying the hook prefix, i.e., who created this hook. And when implementing this hook, it&#39;s also necessary to specify which plugin defined the hook. If not specified, confusion can arise when multiple plugins define hooks with the same name. Furthermore, once the definer explicitly specifies the hook prefix, if the implementer does not specify it, it won&#39;t be recognized. This specification needs to be adhered to by both the definer and the implementer.</p></div><h2 id="hook-implementation" tabindex="-1">Hook Implementation <a class="header-anchor" href="#hook-implementation" aria-label="Permalink to &quot;Hook Implementation&quot;">​</a></h2><p>Hooks can only be recognized in the specified hook directory. This hook directory is configured with <code>hookDir</code> in the plugin&#39;s <code>.semorc.yml</code> file, and then <code>index.js</code> within it is recognized. If the current project is a Typescript project, the <code>index.ts</code> file will be recognized, and the <code>index.js</code> file will be ignored.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hook_bar</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;semo-plugin-foo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">core</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>When multiple plugins genuinely define hooks with the same name, if you happen to need both simultaneously, you can also use the second method like this:</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hook_bar </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;semo-plugin-foo1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {},</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;semo-plugin-foo2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="hook-return-values" tabindex="-1">Hook Return Values <a class="header-anchor" href="#hook-return-values" aria-label="Permalink to &quot;Hook Return Values&quot;">​</a></h2><p>The primary purpose of implementing hooks is to perform certain operations or provide specific information at program execution nodes. For flexibility, returning an object <code>{}</code> directly, a function, or even a <code>Promise</code> function is supported. If it&#39;s a function, its execution result will be obtained and then merged. <code>Promise</code> hooks are widely used because they allow executing asynchronous operations, including but not limited to databases, networks, Redis, ES, etc.</p><p>If the purpose of defining a hook is to collect information, the definer might have various merging requirements. Currently, the following methods are supported, with <code>assign</code> being the default:</p><ul><li>assign: This type overrides based on the keys of the returned object.</li><li>replace: This type overwrites each other, retaining only the return value of the last hook.</li><li>group: This type groups based on the plugin name.</li><li>push: This type puts all return values into an array, typically used when returning primitive data types.</li><li>merge: This type performs a deep merge.</li></ul><h2 id="explanation-of-core-built-in-hooks" tabindex="-1">Explanation of Core Built-in Hooks <a class="header-anchor" href="#explanation-of-core-built-in-hooks" aria-label="Permalink to &quot;Explanation of Core Built-in Hooks&quot;">​</a></h2><p>Since the definer of the hook determines its purpose and return value format, the definer has the obligation to clearly state this information in a specific location, allowing users of the plugin to extend it in their own plugins or applications. Below is the explanation of the core hooks:</p><ul><li><code>before_command</code>: This hook triggers before command execution, does not collect return values.</li><li><code>hook</code>: This hook is used to declare hooks and their purposes. It&#39;s not mandatory but is a convention to let others know which hooks are defined.</li><li><code>repl</code>: Used to inject information into the repl. Does not overwrite each other, generally used for debugging, format is not fixed.</li><li><code>repl_command</code>: Allows third-party plugins to extend commands within the repl.</li><li><code>status</code>: Used to inject new attribute information into the <code>semo status</code> command.</li><li><code>create_project_template</code>: Used to inject optional templates for the <code>--template</code> parameter of the <code>semo create</code> command.</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>In version <code>v1.15.1</code>, the <code>before_command</code> hook has been set to not execute by default.</p><p>Enable it by adding <code>--enable-core-hook=before_command</code> when starting the command.</p></div><p>Usage Examples of Some Core Hooks</p><h3 id="repl-command" tabindex="-1"><code>repl_command</code> <a class="header-anchor" href="#repl-command" aria-label="Permalink to &quot;`repl_command`&quot;">​</a></h3><p>Define a .hello command in REPL mode that accepts parameters.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hook_repl_command</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  semo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      hello: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        help: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clearBufferedCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;world&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">displayPrompt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Here, <code>this.clearBufferedCommand()</code> and <code>this.displayPrompt()</code> are both methods from Node&#39;s REPL class. Note two points: one is that the <code>action</code> here supports <code>async/await</code>, and the other is that to ensure <code>this</code> points correctly, do not write it as an arrow function.</p></div></div></main><footer class="VPDocFooter" data-v-2fac68a6 data-v-22ea5e77><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-22ea5e77><span class="visually-hidden" id="doc-footer-aria-label" data-v-22ea5e77>Pager</span><div class="pager" data-v-22ea5e77><a class="VPLink link pager-link prev" href="/guide/config/" data-v-22ea5e77><!--[--><span class="desc" data-v-22ea5e77>Previous page</span><span class="title" data-v-22ea5e77>Configuration Management</span><!--]--></a></div><div class="pager" data-v-22ea5e77><a class="VPLink link pager-link next" href="/guide/plugin/" data-v-22ea5e77><!--[--><span class="desc" data-v-22ea5e77>Next page</span><span class="title" data-v-22ea5e77>Plugin Development</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-054441f3 data-v-6411c423><div class="container" data-v-6411c423><p class="message" data-v-6411c423>Enterprise level CLI solution</p><!----></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"cn_community_contrib_index.md\":\"BpGCkaca\",\"cn_community_qa_index.md\":\"B_YDr28I\",\"cn_guide_config_index.md\":\"DsfdXL-9\",\"cn_guide_core-commands_index.md\":\"CFuQpR-l\",\"cn_guide_custom-commands_index.md\":\"DwyYOw7r\",\"cn_guide_hook_index.md\":\"va7g2gay\",\"cn_guide_index.md\":\"B3ZG5YpG\",\"cn_guide_plugin_index.md\":\"eof9KRRb\",\"cn_guide_quickstart_index.md\":\"CZQ3C3ER\",\"cn_index.md\":\"6ki72LCu\",\"cn_usage_distribution_index.md\":\"CDiN0Hcy\",\"cn_usage_index.md\":\"CHktnb0M\",\"cn_usage_integration_index.md\":\"BTmCTiFj\",\"cn_usage_plugin_index.md\":\"BCpackY7\",\"cn_usage_solution_index.md\":\"DQGb9ACj\",\"community_contrib_index.md\":\"BZpv3Nph\",\"community_qa_index.md\":\"0jnOXTOE\",\"guide_config_index.md\":\"CQmg1p6H\",\"guide_core-commands_index.md\":\"CXfYfJ1L\",\"guide_custom-commands_index.md\":\"BoYHbkAy\",\"guide_hook_index.md\":\"CJGUZVtA\",\"guide_index.md\":\"D4D2jCDv\",\"guide_plugin_index.md\":\"B-ImcUtn\",\"guide_quickstart_index.md\":\"CvW_aV_X\",\"index.md\":\"ByQMIRTy\",\"usage_distribution_index.md\":\"BPUTOeDG\",\"usage_index.md\":\"CZRI7HYj\",\"usage_integration_index.md\":\"BgNFxjEN\",\"usage_plugin_index.md\":\"BbDMEeiM\",\"usage_solution_index.md\":\"BoCDdOsZ\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Semo\",\"description\":\"A command line tool for building enterprise-level Node.js project command line systems\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"search\":{\"provider\":\"local\"}},\"locales\":{\"cn\":{\"label\":\"中文\",\"lang\":\"zh\",\"link\":\"/cn/\",\"themeConfig\":{\"footer\":{\"message\":\"企业级Node项目命令行体系建设规范\"},\"nav\":[{\"text\":\"首页\",\"link\":\"/cn/\"},{\"text\":\"指南\",\"link\":\"/cn/guide/\"},{\"text\":\"用法\",\"link\":\"/cn/usage/\"},{\"text\":\"参考\",\"link\":\"http://semo.js.org/typedoc/\"}],\"sidebar\":[{\"text\":\"基础\",\"collapsed\":false,\"items\":[{\"text\":\"介绍\",\"link\":\"/cn/guide/\"},{\"text\":\"快速上手\",\"link\":\"/cn/guide/quickstart/\"},{\"text\":\"核心命令\",\"link\":\"/cn/guide/core-commands/\"},{\"text\":\"自定义命令\",\"link\":\"/cn/guide/custom-commands/\"},{\"text\":\"配置管理\",\"link\":\"/cn/guide/config/\"},{\"text\":\"钩子机制\",\"link\":\"/cn/guide/hook/\"},{\"text\":\"插件开发\",\"link\":\"/cn/guide/plugin/\"}]},{\"text\":\"用法\",\"collapsed\":false,\"items\":[{\"text\":\"概述\",\"link\":\"/cn/usage/\"},{\"text\":\"插件\",\"link\":\"/cn/usage/plugin/\"},{\"text\":\"项目整合\",\"link\":\"/cn/usage/integration/\"},{\"text\":\"解决方案\",\"link\":\"/cn/usage/solution/\"},{\"text\":\"发行版\",\"link\":\"/cn/usage/distribution/\"}]},{\"text\":\"社区\",\"collapsed\":false,\"items\":[{\"text\":\"如何贡献\",\"link\":\"/cn/community/contrib/\"},{\"text\":\"常见问题\",\"link\":\"/cn/community/qa/\"}]}]}},\"root\":{\"label\":\"English\",\"lang\":\"en\",\"link\":\"/\",\"themeConfig\":{\"footer\":{\"message\":\"Enterprise level CLI solution\"},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Guide\",\"link\":\"/guide/\"},{\"text\":\"Usage\",\"link\":\"/usage/\"},{\"text\":\"Reference\",\"link\":\"http://semo.js.org/typedoc/\"}],\"sidebar\":[{\"text\":\"Guide\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"link\":\"/guide/\"},{\"text\":\"Quick Start\",\"link\":\"/guide/quickstart/\"},{\"text\":\"Core Commands\",\"link\":\"/guide/core-commands/\"},{\"text\":\"Custom Commands\",\"link\":\"/guide/custom-commands/\"},{\"text\":\"Configuration Management\",\"link\":\"/guide/config/\"},{\"text\":\"Hook Mechanism\",\"link\":\"/guide/hook/\"},{\"text\":\"Plugin Development\",\"link\":\"/guide/plugin/\"}]},{\"text\":\"Usage\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/usage/\"},{\"text\":\"Plugins\",\"link\":\"/usage/plugin/\"},{\"text\":\"Project Integration\",\"link\":\"/usage/integration/\"},{\"text\":\"Solutions\",\"link\":\"/usage/solution/\"},{\"text\":\"Distribution\",\"link\":\"/usage/distribution/\"}]},{\"text\":\"Community\",\"collapsed\":false,\"items\":[{\"text\":\"How to Contribute\",\"link\":\"/community/contrib/\"},{\"text\":\"Frequently Asked Questions\",\"link\":\"/community/qa/\"}]}]}}},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>