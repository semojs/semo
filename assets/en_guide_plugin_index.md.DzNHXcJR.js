import{_ as e,v as i}from"./chunks/framework.l0izGjY3.js";import"./chunks/theme.sGipRxBs.js";const c=JSON.parse('{"title":"Plugin Development","description":"","frontmatter":{},"headers":[],"relativePath":"en/guide/plugin/index.md","filePath":"en/guide/plugin/index.md"}'),a={name:"en/guide/plugin/index.md"};function n(t,s,l,o,p,h){return i.openBlock(),i.createElementBlock("div",null,s[0]||(s[0]=[i.createStaticVNode(`<h1 id="plugin-development" tabindex="-1">Plugin Development <a class="header-anchor" href="#plugin-development" aria-label="Permalink to &quot;Plugin Development&quot;">​</a></h1><h2 id="quick-start" tabindex="-1">Quick Start <a class="header-anchor" href="#quick-start" aria-label="Permalink to &quot;Quick Start&quot;">​</a></h2><p>A <code>Semo</code> plugin is essentially a standard <code>Node</code> module, albeit with some conventions regarding directory and file structure. These conventions can be challenging to remember, so we provide various auxiliary tools for plugin developers or tool users, such as code generation. Here, we describe the recommended plugin development process. However, once you&#39;re familiar with the development process, you can also manually build a plugin from an empty directory.</p><h3 id="step-1-create-plugin-directory-based-on-template" tabindex="-1">Step 1: Create Plugin Directory Based on Template <a class="header-anchor" href="#step-1-create-plugin-directory-based-on-template" aria-label="Permalink to &quot;Step 1: Create Plugin Directory Based on Template&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> semo-plugin-xyz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --template=plugin</span></span></code></pre></div><p>Here, we use the built-in plugin template. As mentioned earlier in configuration management, you can override the <code>repo</code> and <code>branch</code> options or the <code>--template</code> option to avoid passing default parameters each time.</p><h3 id="step-2-enter-plugin-directory-and-execute-default-command-to-confirm-everything-is-fine" tabindex="-1">Step 2: Enter Plugin Directory and Execute Default Command to Confirm Everything is Fine <a class="header-anchor" href="#step-2-enter-plugin-directory-and-execute-default-command-to-confirm-everything-is-fine" aria-label="Permalink to &quot;Step 2: Enter Plugin Directory and Execute Default Command to Confirm Everything is Fine&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> semo-plugin-xyz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hi</span></span></code></pre></div><p>This is a command built into the plugin template. After initialization, you can execute it by entering the directory, confirming the initial interaction with the plugin command. If you see it respond with <code>Hey you!</code>, everything is ready, and you can proceed to write scripts that will truly change the world.</p><h2 id="adding-commands" tabindex="-1">Adding Commands <a class="header-anchor" href="#adding-commands" aria-label="Permalink to &quot;Adding Commands&quot;">​</a></h2><p>It&#39;s worth noting that this plugin template is based on <code>Typescript</code>, so you need some <code>Typescript</code> basics. We recommend keeping the <code>yarn watch</code> command running during development to compile in real-time while developing and testing simultaneously.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xyz</span></span></code></pre></div><p>Typically, there&#39;s a correlation between the plugin name and the commands it encapsulates. Here, we add an <code>xyz</code> command, but you can also modify the existing <code>hi</code> command. Once you&#39;ve mastered plugin development, it&#39;s advisable to remove the default <code>hi</code> command.</p><h2 id="implementing-hooks" tabindex="-1">Implementing Hooks <a class="header-anchor" href="#implementing-hooks" aria-label="Permalink to &quot;Implementing Hooks&quot;">​</a></h2><p>Implementing hooks is another purpose of plugin development. Hooks are often defined by other plugins or business projects, and implementing hooks can influence and change the behavior of other plugins.</p><p>Use the following command to query which hooks are supported in the current environment:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span></code></pre></div><h3 id="example-1-implementing-hook-create-project-template" tabindex="-1">Example 1: Implementing <code>hook_create_project_template</code> <a class="header-anchor" href="#example-1-implementing-hook-create-project-template" aria-label="Permalink to &quot;Example 1: Implementing \`hook_create_project_template\`&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/hooks/index.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> semo__hook_create_project_template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  demo_repo: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    repo: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;demo_repo.git&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    branch: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;master&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    alias: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;demo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>With this hook, we can select a custom project template when executing the <code>semo create [PROJECT] --template</code> command, just by remembering the alias, without needing to remember the address. Another advantage is that you don&#39;t need to manage how each engineer sets the global <code>--repo</code> option on their personal computer. As long as the specified plugin is installed, everyone can initialize projects with the same project alias.</p><h3 id="example-2-implementing-hook-repl" tabindex="-1">Example 2: Implementing <code>hook_repl</code> <a class="header-anchor" href="#example-2-implementing-hook-repl" aria-label="Permalink to &quot;Example 2: Implementing \`hook_repl\`&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/hooks/index.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> semo__hook_repl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    multiple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Then, in the REPL environment, you can use these:</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Information returned by <code>hook_repl</code> is injected into the Semo object in the REPL.</p></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> repl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Function: add]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">await</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Semo.add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">multiple</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Function: multiple]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">await</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Semo.multiple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">12</span></span></code></pre></div><p>The motivations behind implementing this hook differ between plugins and business projects. Business projects generally inject specific business logic, while plugins typically inject common methods with some degree of reusability, such as injecting instance methods of underlying services, commonly used libraries, etc. For example, the <code>Utils</code> core injection contains the <code>lodash</code> library.</p><h2 id="exposing-methods" tabindex="-1">Exposing Methods <a class="header-anchor" href="#exposing-methods" aria-label="Permalink to &quot;Exposing Methods&quot;">​</a></h2><p>Another primary purpose of implementing plugins is to expose instances, methods, or libraries externally. In this case, we can define modules in a standard way, for example:</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Since <code>Semo</code> later introduced the <code>run</code> command, which depends on the entry file for locating, it requires plugins of <code>Semo</code> to declare an entry, regardless of whether this entry exposes methods.</p></div><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// package.json</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;main&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lib/index.js&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// index.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span></code></pre></div><p>This approach is fine, but typically, modules defined in this way don&#39;t need to adhere to <code>Semo</code>&#39;s conventions. As long as they comply with <code>node</code> and <code>npm</code> standards, they are acceptable. Here, <code>Semo</code> defines another way to expose methods based on the hook mechanism.</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/hooks/index.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> semo__hook_component</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  return {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Usage:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Utils } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@semo/core&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">invokeHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;semo:component&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// -&gt; &#39;b&#39;</span></span></code></pre></div><p>With this approach, we can encapsulate some common methods of business projects for cross-project use. These common methods typically lean towards the lower level, such as various middlewares or underlying services.</p><h2 id="publishing-plugins" tabindex="-1">Publishing Plugins <a class="header-anchor" href="#publishing-plugins" aria-label="Permalink to &quot;Publishing Plugins&quot;">​</a></h2><p>After using commands, hooks, or</p><p>library extensions, we&#39;ve developed a <code>Semo</code> plugin. If you want to share your plugin with others, you need to do some preparation work.</p><h3 id="_1-upload-code-to-a-git-repository" tabindex="-1">1. Upload Code to a Git Repository <a class="header-anchor" href="#_1-upload-code-to-a-git-repository" aria-label="Permalink to &quot;1. Upload Code to a Git Repository&quot;">​</a></h3><p>If it&#39;s open-source, you can choose <code>Github</code>. If it&#39;s an internal plugin, upload it to an internal repository, which could be a private <code>Github</code> repository or a company <code>Gitlab</code> repository.</p><h3 id="_2-modify-package-json" tabindex="-1">2. Modify <code>package.json</code> <a class="header-anchor" href="#_2-modify-package-json" aria-label="Permalink to &quot;2. Modify \`package.json\`&quot;">​</a></h3><p>Mainly modify the package name, version, license, repository address, homepage address, etc.</p><p>If it&#39;s an internal plugin, you can modify the <code>registry</code> address in the <code>.npmrc</code> file.</p><h3 id="_3-obtain-an-account-for-the-npm-registry-and-log-in" tabindex="-1">3. Obtain an Account for the npm Registry and Log In <a class="header-anchor" href="#_3-obtain-an-account-for-the-npm-registry-and-log-in" aria-label="Permalink to &quot;3. Obtain an Account for the npm Registry and Log In&quot;">​</a></h3><p>For open-source plugins, you can register at <code>https://npmjs.org</code>. For privately deployed npm repositories, you can get an account from your operations team.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> login</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --registry=[YOUR_REGISTRY]</span></span></code></pre></div><h3 id="_4-test-the-plugin-package" tabindex="-1">4. Test the Plugin Package <a class="header-anchor" href="#_4-test-the-plugin-package" aria-label="Permalink to &quot;4. Test the Plugin Package&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pack</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dry-run</span></span></code></pre></div><p>Through packaging testing, check whether the package contains any unnecessary files, and adjust the configuration of the <code>.npmignore</code> file accordingly.</p><h3 id="_5-publish-your-plugin" tabindex="-1">5. Publish Your Plugin <a class="header-anchor" href="#_5-publish-your-plugin" aria-label="Permalink to &quot;5. Publish Your Plugin&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [patch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">minor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">major]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> publish</span></span></code></pre></div><h3 id="_6-promote-your-plugin-and-share-development-insights" tabindex="-1">6. Promote Your Plugin and Share Development Insights <a class="header-anchor" href="#_6-promote-your-plugin-and-share-development-insights" aria-label="Permalink to &quot;6. Promote Your Plugin and Share Development Insights&quot;">​</a></h3><p>Good documentation is crucial, as well as actively promoting and encouraging others to use and provide feedback on your plugin.</p><h3 id="_7-actively-maintain" tabindex="-1">7. Actively Maintain <a class="header-anchor" href="#_7-actively-maintain" aria-label="Permalink to &quot;7. Actively Maintain&quot;">​</a></h3><p>Any npm package can gradually become outdated or have security risks, so it&#39;s essential to actively maintain your plugin to ensure it functions as intended.</p><h2 id="plugin-hierarchy" tabindex="-1">Plugin Hierarchy <a class="header-anchor" href="#plugin-hierarchy" aria-label="Permalink to &quot;Plugin Hierarchy&quot;">​</a></h2><p>The <code>Semo</code> plugin system scans multiple locations to increase flexibility, with each level serving different purposes and restrictions.</p><ul><li>Installed globally via <code>npm install -g semo-plugin-xxx</code>, so commands from installed plugins are globally available. This is the default global installation method for npm packages.</li><li>Installed in the home directory&#39;s <code>.semo/home-plugin-cache</code> directory via <code>semo plugin install semo-plugin-xxx</code>, and the plugin commands are also globally available. In certain cases where the current user lacks permission to install globally via npm, this method can be used.</li><li>Installed in the current project directory via <code>npm install semo-plugin-xxx</code>. Plugin commands installed this way are only effective within the current project.</li></ul><p>Why would some plugins need to be installed globally? Because plugins can not only fulfill our project&#39;s business requirements but also serve as part of our development toolchain or even implement some non-business functionalities. With some imagination, any terminal functionality can be implemented, either completely handwritten or encapsulated and integrated with other excellent projects. Here, excellent projects are not limited to specific languages or language extension package repositories.</p><h2 id="running-remote-plugins-directly" tabindex="-1">Running Remote Plugins Directly <a class="header-anchor" href="#running-remote-plugins-directly" aria-label="Permalink to &quot;Running Remote Plugins Directly&quot;">​</a></h2><p>This is just an illusion; it still needs to be downloaded locally, but the download directory is different, avoiding interference with your implementation. You can freely test plugins you&#39;re interested in.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> semo-plugin-serve</span></span></code></pre></div><p>This plugin provides a simple HTTP service. The first time you run it, it will download, and subsequently, it will reuse the previously downloaded plugin. Use <code>--force</code> to force an update.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Subsequent development will include a feature to clean plugin caches.</p></div><h2 id="special-home-directory-plugins" tabindex="-1">Special Home Directory Plugins <a class="header-anchor" href="#special-home-directory-plugins" aria-label="Permalink to &quot;Special Home Directory Plugins&quot;">​</a></h2><blockquote><p>This feature was introduced in <code>v0.8.0</code></p></blockquote><p>To add global configurations to <code>Semo</code>, you need to add a <code>.semorc.yml</code> configuration file in the <code>~/.semo</code> directory. Once this configuration file is established, the <code>.semo</code> directory is automatically recognized as a global plugin (other global plugins are in the <code>.semo/home-plugin-cache</code> directory). Here, you can define your own commands, extend other plugins&#39; commands, or extend other plugins&#39; hooks, etc. This special plugin is globally recognizable. Also, because it&#39;s present by default, if you have some locally common logic and don&#39;t want to publish it as an npm package, you can quickly start here. However, be aware of its global availability, as errors here can affect the local global state.</p><p>We don&#39;t prescribe a specific implementation approach for this special plugin. You can use <code>js</code> or <code>typescript</code> to write it. You can initialize the basic directory structure using <code>semo init</code>, or regenerate a <code>.semo</code> directory with the template using <code>semo create .semo --template=pluging</code> (backup the <code>.semo</code> directory in advance, then merge the contents back).</p><h2 id="recognizing-plugins-in-any-directory" tabindex="-1">Recognizing Plugins in Any Directory <a class="header-anchor" href="#recognizing-plugins-in-any-directory" aria-label="Permalink to &quot;Recognizing Plugins in Any Directory&quot;">​</a></h2><p>We can see the <code>pluginDir</code> configuration in the configuration file. If you manually specify this parameter on the command line, you can achieve any specific directory purpose, and it also supports multiple directories:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> help</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --plugin-dir=dir1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --plugin-dir=dir2</span></span></code></pre></div><p>Additionally, it supports specifying via constants:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SEMO_PLUGIN_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">dir3</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> semo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> help</span></span></code></pre></div><h2 id="issue-with-internal-plugins-defined-in-applications-in-typescript-mode" tabindex="-1">Issue with Internal Plugins Defined in Applications in Typescript Mode <a class="header-anchor" href="#issue-with-internal-plugins-defined-in-applications-in-typescript-mode" aria-label="Permalink to &quot;Issue with Internal Plugins Defined in Applications in Typescript Mode&quot;">​</a></h2><p>This is because <code>tsc</code> can only recognize <code>ts</code> and <code>js</code> related files during compilation and cannot recognize our <code>yml</code> format. Moreover, the official doesn&#39;t intend to support copying files other than <code>ts</code>. As <code>ts</code> is not a complete build tool, we need to manually copy the required files. This can be achieved using <code>cpy-cli</code> or <code>copyfiles</code>. Taking <code>copyfiles</code> as an example:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// package.json</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;scripts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;copyfiles&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;copyfiles -u 1 -a src/**/*.yml dist -E&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="plugin-s-active-registration-mechanism" tabindex="-1">Plugin&#39;s Active Registration Mechanism <a class="header-anchor" href="#plugin-s-active-registration-mechanism" aria-label="Permalink to &quot;Plugin&#39;s Active Registration Mechanism&quot;">​</a></h2><blockquote><p>Introduced in <code>v1.3.0</code></p></blockquote><p>In the early days, <code>Semo</code> only supported the automatic registration mechanism for plugins. To increase flexibility, it could traverse multiple locations, albeit with some IO performance loss. Therefore, the active registration mechanism was introduced. Once the active registration mechanism is used, the automatic registration mechanism becomes ineffective.</p><h3 id="activation-method" tabindex="-1">Activation Method <a class="header-anchor" href="#activation-method" aria-label="Permalink to &quot;Activation Method&quot;">​</a></h3><p>Write plugin key-value pairs in the <code>$plugins</code> section of <code>.semorc.yml</code></p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">$plugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    plugin-a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/absolute/path</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    plugin-b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./relative/path</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    plugin-c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div><p>Three styles are supported: absolute paths, relative paths, and using Node.js module loading mechanisms for declaration. Here, the <code>semo-plugin-</code> prefix can be omitted for plugin names used as keys. Additionally, the shorthand <code>~</code> for the home directory is supported.</p>`,84)]))}const k=e(a,[["render",n]]);export{c as __pageData,k as default};
