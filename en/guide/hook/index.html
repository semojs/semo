<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hook Mechanism | Semo</title>
    <meta name="description" content="一个命令行工具">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.pPpfxpy6.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DbXdkqVg.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.D9cKc6b5.js">
    <link rel="modulepreload" href="/assets/chunks/framework.BJMphyNv.js">
    <link rel="modulepreload" href="/assets/en_guide_hook_index.md.DVtTq-m7.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-32f6a11a><!--[--><!--]--><!--[--><span tabindex="-1" data-v-7aa664e1></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-7aa664e1>Skip to content</a><!--]--><!----><header class="VPNav" data-v-32f6a11a data-v-8e19932b><div class="VPNavBar" data-v-8e19932b data-v-716a1440><div class="wrapper" data-v-716a1440><div class="container" data-v-716a1440><div class="title" data-v-716a1440><div class="VPNavBarTitle has-sidebar" data-v-716a1440 data-v-6f43652a><a class="title" href="/en/" data-v-6f43652a><!--[--><!--]--><!----><span data-v-6f43652a>Semo</span><!--[--><!--]--></a></div></div><div class="content" data-v-716a1440><div class="content-body" data-v-716a1440><!--[--><!--]--><div class="VPNavBarSearch search" data-v-716a1440><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-716a1440 data-v-e4b823fb><span id="main-nav-aria-label" class="visually-hidden" data-v-e4b823fb> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/en/" tabindex="0" data-v-e4b823fb data-v-f58e9332><!--[--><span data-v-f58e9332>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/en/guide/" tabindex="0" data-v-e4b823fb data-v-f58e9332><!--[--><span data-v-f58e9332>Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/en/usage/" tabindex="0" data-v-e4b823fb data-v-f58e9332><!--[--><span data-v-f58e9332>Usage</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="http://semo.js.org/typedoc/" target="_blank" rel="noreferrer" tabindex="0" data-v-e4b823fb data-v-f58e9332><!--[--><span data-v-f58e9332>Reference</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-716a1440 data-v-2f847458 data-v-4b83c3e8><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-4b83c3e8><span class="text" data-v-4b83c3e8><span class="vpi-languages option-icon" data-v-4b83c3e8></span><!----><span class="vpi-chevron-down text-icon" data-v-4b83c3e8></span></span></button><div class="menu" data-v-4b83c3e8><div class="VPMenu" data-v-4b83c3e8 data-v-354710f4><!----><!--[--><!--[--><div class="items" data-v-2f847458><p class="title" data-v-2f847458>English</p><!--[--><div class="VPMenuLink" data-v-2f847458 data-v-8f2a620c><a class="VPLink link" href="/guide/hook/" data-v-8f2a620c><!--[--><span data-v-8f2a620c>中文</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-716a1440 data-v-15e2e071><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-15e2e071 data-v-0849e505 data-v-7b294bfe><span class="check" data-v-7b294bfe><span class="icon" data-v-7b294bfe><!--[--><span class="vpi-sun sun" data-v-0849e505></span><span class="vpi-moon moon" data-v-0849e505></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-716a1440 data-v-b754ac10 data-v-4b83c3e8><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-4b83c3e8><span class="vpi-more-horizontal icon" data-v-4b83c3e8></span></button><div class="menu" data-v-4b83c3e8><div class="VPMenu" data-v-4b83c3e8 data-v-354710f4><!----><!--[--><!--[--><div class="group translations" data-v-b754ac10><p class="trans-title" data-v-b754ac10>English</p><!--[--><div class="VPMenuLink" data-v-b754ac10 data-v-8f2a620c><a class="VPLink link" href="/guide/hook/" data-v-8f2a620c><!--[--><span data-v-8f2a620c>中文</span><!--]--></a></div><!--]--></div><div class="group" data-v-b754ac10><div class="item appearance" data-v-b754ac10><p class="label" data-v-b754ac10>Appearance</p><div class="appearance-action" data-v-b754ac10><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-b754ac10 data-v-0849e505 data-v-7b294bfe><span class="check" data-v-7b294bfe><span class="icon" data-v-7b294bfe><!--[--><span class="vpi-sun sun" data-v-0849e505></span><span class="vpi-moon moon" data-v-0849e505></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-716a1440 data-v-763deb14><span class="container" data-v-763deb14><span class="top" data-v-763deb14></span><span class="middle" data-v-763deb14></span><span class="bottom" data-v-763deb14></span></span></button></div></div></div></div><div class="divider" data-v-716a1440><div class="divider-line" data-v-716a1440></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-32f6a11a data-v-af51e573><div class="container" data-v-af51e573><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-af51e573><span class="vpi-align-left menu-icon" data-v-af51e573></span><span class="menu-text" data-v-af51e573>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-af51e573 data-v-f3d2de30><button data-v-f3d2de30>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-32f6a11a data-v-00b077eb><div class="curtain" data-v-00b077eb></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-00b077eb><span class="visually-hidden" id="sidebar-aria-label" data-v-00b077eb> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-78e97467><section class="VPSidebarItem level-0 collapsible has-active" data-v-78e97467 data-v-d5b912d8><div class="item" role="button" tabindex="0" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><h2 class="text" data-v-d5b912d8>Guide</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d5b912d8><span class="vpi-chevron-right caret-icon" data-v-d5b912d8></span></div></div><div class="items" data-v-d5b912d8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/guide/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Introduction</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/guide/quickstart/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Quick Start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/guide/core-commands/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Core Commands</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/guide/core-commands/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Custom Commands</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/guide/config/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Configuration Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/guide/hook/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Hook Mechanism</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/guide/plugin/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Plugin Development</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-78e97467><section class="VPSidebarItem level-0 collapsible" data-v-78e97467 data-v-d5b912d8><div class="item" role="button" tabindex="0" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><h2 class="text" data-v-d5b912d8>Usage</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d5b912d8><span class="vpi-chevron-right caret-icon" data-v-d5b912d8></span></div></div><div class="items" data-v-d5b912d8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/usage/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/usage/plugin/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/usage/integration/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Project Integration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/usage/solution/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Solutions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/usage/distribution/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Distribution</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-78e97467><section class="VPSidebarItem level-0 collapsible" data-v-78e97467 data-v-d5b912d8><div class="item" role="button" tabindex="0" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><h2 class="text" data-v-d5b912d8>Community</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d5b912d8><span class="vpi-chevron-right caret-icon" data-v-d5b912d8></span></div></div><div class="items" data-v-d5b912d8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/community/contrib/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>How to Contribute</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d5b912d8 data-v-d5b912d8><div class="item" data-v-d5b912d8><div class="indicator" data-v-d5b912d8></div><a class="VPLink link link" href="/en/community/qa/" data-v-d5b912d8><!--[--><p class="text" data-v-d5b912d8>Frequently Asked Questions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-32f6a11a data-v-4602a5a1><div class="VPDoc has-sidebar has-aside" data-v-4602a5a1 data-v-022997c1><!--[--><!--]--><div class="container" data-v-022997c1><div class="aside" data-v-022997c1><div class="aside-curtain" data-v-022997c1></div><div class="aside-container" data-v-022997c1><div class="aside-content" data-v-022997c1><div class="VPDocAside" data-v-022997c1 data-v-40367621><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-40367621 data-v-b41c5656><div class="content" data-v-b41c5656><div class="outline-marker" data-v-b41c5656></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b41c5656>On this page</div><ul class="VPDocOutlineItem root" data-v-b41c5656 data-v-2b6a8827><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-40367621></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-022997c1><div class="content-container" data-v-022997c1><!--[--><!--]--><main class="main" data-v-022997c1><div style="position:relative;" class="vp-doc _en_guide_hook_" data-v-022997c1><div><h1 id="hook-mechanism" tabindex="-1">Hook Mechanism <a class="header-anchor" href="#hook-mechanism" aria-label="Permalink to &quot;Hook Mechanism&quot;">​</a></h1><p>As a command-line development framework that leans toward the lower level, having a plugin system is essential. This is especially true for frameworks like <code>Semo</code>, which don&#39;t inherently provide direct business value. Besides providing users with plugin scanning, command extension, and configuration management mechanisms, the hook mechanism is also a significant enhancement for flexibility and extensibility, forming part of the <code>Semo</code> plugin system.</p><p>The concept of hooks is quite understandable and ubiquitous. For instance, consider Windows startup programs. At certain stages during startup, Windows checks if any other applications need to start concurrently. Implementing this functionality certainly requires configuration, such as in the Windows registry or a configuration file.</p><p>The hook mechanism in <code>Semo</code> is convention-based and dynamically recognized. Each plugin&#39;s hooks are determined during command execution, causing some performance overhead in terms of disk I/O and traversal. However, considering that command execution logic is generally not overly complex, this approach is deemed sufficient for now. If complex hook invocation chains arise in the future, optimization may be considered, which typically involves transitioning from dynamic to static or utilizing caching for speed enhancement.</p><h2 id="hook-definition" tabindex="-1">Hook Definition <a class="header-anchor" href="#hook-definition" aria-label="Permalink to &quot;Hook Definition&quot;">​</a></h2><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Define a hook named &#39;hook_bar&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hookData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">invokeHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;semo-plugin-foo:hook_bar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;group&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Starting from <code>v1.0.0</code>, hook invocation requires specifying the hook prefix, indicating who created the hook. When implementing the hook, it&#39;s necessary to specify which plugin defined the hook. Failure to specify may cause confusion when multiple plugins define hooks with the same name. Once the defining party explicitly specifies the hook prefix, the implementation party won&#39;t be recognized unless it also specifies it. Both parties need to adhere to this convention.</p></div><h2 id="hook-implementation" tabindex="-1">Hook Implementation <a class="header-anchor" href="#hook-implementation" aria-label="Permalink to &quot;Hook Implementation&quot;">​</a></h2><p>Hooks can only be recognized in designated hook directories, which are configured in the <code>.semorc.yml</code> file of the plugin under the <code>hookDir</code> key, and then recognized inside the <code>index.js</code>.</p><p>Currently, there are two styles for implementing hooks:</p><p>The first style prefixes the hook with the hook prefix, separated by hyphens.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semo_plugin_foo__hook_bar</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span></code></pre></div><p>The second style declares the hook prefix using <code>Semo</code>&#39;s built-in hook class object.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hook_bar </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;semo-plugin-foo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {})</span></span></code></pre></div><p>When multiple plugins define hooks with the same name and you need them all, you can use the second style like this:</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hook_bar </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;semo-plugin-foo1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {},</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;semo-plugin-foo2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>For third-party plugins, if they need to use <code>Utils.Hook</code>, which requires adding a dependency on <code>@semo/core</code>, another style can be used to omit this dependency.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Utils) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  return {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    hook_bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;semo-plugin-foo1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {},</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;semo-plugin-foo2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="hook-return-values" tabindex="-1">Hook Return Values <a class="header-anchor" href="#hook-return-values" aria-label="Permalink to &quot;Hook Return Values&quot;">​</a></h2><p>The main purpose of hook implementation is to perform certain operations at program execution nodes or provide certain information. For flexibility, direct object <code>{}</code> returns, functions, or even <code>Promise</code> functions are supported. If it&#39;s a function, the result of the function&#39;s execution will be merged. <code>Promise</code> hooks are widely used because they allow for asynchronous operations, including but not limited to database, network, Redis, and Elasticsearch operations.</p><p>If the purpose of a hook definition is to collect information, the defining party may have various merging requirements. Currently, the following merging methods are supported, with <code>assign</code> being the default:</p><ul><li><code>assign</code>: Overrides based on the keys of the returned object</li><li><code>replace</code>: Mutual override, retaining only the last hook&#39;s return value</li><li><code>group</code>: Grouping based on plugin names</li><li><code>push</code>: Places all return values into an array, generally used for basic data types</li><li><code>merge</code>: Performs deep merging</li></ul><h2 id="explanation-of-core-built-in-hooks" tabindex="-1">Explanation of Core Built-in Hooks <a class="header-anchor" href="#explanation-of-core-built-in-hooks" aria-label="Permalink to &quot;Explanation of Core Built-in Hooks&quot;">​</a></h2><p>As the purpose and return value format of hooks are determined by the hook definition party, the defining party has the obligation to explicitly specify these details in a clear location, enabling plugin users to extend their own plugins or applications accordingly. Here are explanations of some core hooks:</p><ul><li><code>before_command</code>: Triggered before command execution, does not collect return values</li><li><code>after_command</code>: Triggered after command execution, does not collect return values</li><li><code>component</code>: Used to collect some components defined in plugins, generally returns an object containing instances, for example <code>{ redis, db }</code></li><li><code>hook</code>: Used to declare hooks and their purposes. While not mandatory, it&#39;s a convention that informs others of which hooks are defined</li><li><code>repl</code>: Injects information into the REPL, does not override each other, typically used for debugging, format is not fixed</li><li><code>repl_command</code>: Allows third-party plugins to extend commands in the REPL</li><li><code>status</code>: Injects new property information into the <code>semo status</code> command</li><li><code>create_project_template</code>: Injects optional templates into the <code>semo create</code> command&#39;s <code>--template</code> parameter</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Starting from <code>v1.15.1</code>, the <code>before_command</code> and <code>after-command</code> hooks are set to not execute by default.</p><p>To enable them during command startup, add <code>--enable-core-hook=before_command</code> and <code>--enable-core-hook=after_command</code>.</p></div><p>Examples of using some core hooks</p><h3 id="repl-command" tabindex="-1"><code>repl_command</code> <a class="header-anchor" href="#repl-command" aria-label="Permalink to &quot;`repl_command`&quot;">​</a></h3><p>Defines a .hello command in REPL mode, accepting parameters</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hook_repl_command</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Hook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;semo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    hello: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      help: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clearBufferedCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;world&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">displayPrompt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>Here, <code>this.clearBufferedCommand()</code> and <code>this.displayPrompt()</code> are methods of Node&#39;s REPL class. Note two things: one is that the <code>action</code> here supports <code>async/await</code>, and the other is that for <code>this</code> to correctly point to the REPL, arrow functions should not be used.</p></div></div></main><footer class="VPDocFooter" data-v-022997c1 data-v-be322068><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-be322068><span class="visually-hidden" id="doc-footer-aria-label" data-v-be322068>Pager</span><div class="pager" data-v-be322068><a class="VPLink link pager-link prev" href="/en/guide/config/" data-v-be322068><!--[--><span class="desc" data-v-be322068>Previous page</span><span class="title" data-v-be322068>Configuration Management</span><!--]--></a></div><div class="pager" data-v-be322068><a class="VPLink link pager-link next" href="/en/guide/plugin/" data-v-be322068><!--[--><span class="desc" data-v-be322068>Next page</span><span class="title" data-v-be322068>Plugin Development</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-32f6a11a data-v-c63b8b43><div class="container" data-v-c63b8b43><p class="message" data-v-c63b8b43>Enterprise level CLI rules</p><!----></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"community_contrib_index.md\":\"B82_lKB4\",\"community_qa_index.md\":\"CB4sJYKb\",\"en_community_contrib_index.md\":\"DkQN0G55\",\"en_community_qa_index.md\":\"B5SqrSiT\",\"en_guide_config_index.md\":\"MCGb2HpU\",\"en_guide_core-commands_index.md\":\"BFcn7my6\",\"en_guide_custom-commands_index.md\":\"CpCItC8n\",\"en_guide_hook_index.md\":\"DVtTq-m7\",\"en_guide_index.md\":\"D-sYS0oV\",\"en_guide_plugin_index.md\":\"D2lW2cYn\",\"en_guide_quickstart_index.md\":\"DfxwkN4x\",\"en_index.md\":\"CPNfpfBm\",\"en_usage_distribution_index.md\":\"B20ML7U4\",\"en_usage_index.md\":\"fnyF8ffl\",\"en_usage_integration_index.md\":\"BJkRScxi\",\"en_usage_plugin_index.md\":\"QjoemaOm\",\"en_usage_solution_index.md\":\"BYh90XhU\",\"guide_config_index.md\":\"Ic2kKTIk\",\"guide_core-commands_index.md\":\"CI2nSm9E\",\"guide_custom-commands_index.md\":\"g-JeG_wB\",\"guide_hook_index.md\":\"DUpDhmo9\",\"guide_index.md\":\"CIQ6a3fh\",\"guide_plugin_index.md\":\"Db0OCffK\",\"guide_quickstart_index.md\":\"BTbVHFa-\",\"index.md\":\"CMvEVpPU\",\"usage_distribution_index.md\":\"Bd1HOVYc\",\"usage_index.md\":\"DitAhv0_\",\"usage_integration_index.md\":\"Cj0eh2XT\",\"usage_plugin_index.md\":\"BpTlZ057\",\"usage_solution_index.md\":\"CvGWJevm\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Semo\",\"description\":\"一个命令行工具\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"search\":{\"provider\":\"local\"}},\"locales\":{\"root\":{\"label\":\"中文\",\"lang\":\"zh\",\"link\":\"/\",\"themeConfig\":{\"footer\":{\"message\":\"企业级Node项目命令行体系建设规范\"},\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"指南\",\"link\":\"/guide/\"},{\"text\":\"用法\",\"link\":\"/usage/\"},{\"text\":\"参考\",\"link\":\"http://semo.js.org/typedoc/\"}],\"sidebar\":[{\"text\":\"基础\",\"collapsed\":false,\"items\":[{\"text\":\"介绍\",\"link\":\"/guide/\"},{\"text\":\"快速上手\",\"link\":\"/guide/quickstart/\"},{\"text\":\"核心命令\",\"link\":\"/guide/core-commands/\"},{\"text\":\"自定义命令\",\"link\":\"/guide/custom-commands/\"},{\"text\":\"配置管理\",\"link\":\"/guide/config/\"},{\"text\":\"钩子机制\",\"link\":\"/guide/hook/\"},{\"text\":\"插件开发\",\"link\":\"/guide/plugin/\"}]},{\"text\":\"用法\",\"collapsed\":false,\"items\":[{\"text\":\"概述\",\"link\":\"/usage/\"},{\"text\":\"插件\",\"link\":\"/usage/plugin/\"},{\"text\":\"项目整合\",\"link\":\"/usage/integration/\"},{\"text\":\"解决方案\",\"link\":\"/usage/solution/\"},{\"text\":\"发行版\",\"link\":\"/usage/distribution/\"}]},{\"text\":\"社区\",\"collapsed\":false,\"items\":[{\"text\":\"如何贡献\",\"link\":\"/community/contrib/\"},{\"text\":\"常见问题\",\"link\":\"/community/qa/\"}]}]}},\"en\":{\"label\":\"English\",\"lang\":\"en\",\"link\":\"/en/\",\"themeConfig\":{\"footer\":{\"message\":\"Enterprise level CLI rules\"},\"nav\":[{\"text\":\"Home\",\"link\":\"/en/\"},{\"text\":\"Guide\",\"link\":\"/en/guide/\"},{\"text\":\"Usage\",\"link\":\"/en/usage/\"},{\"text\":\"Reference\",\"link\":\"http://semo.js.org/typedoc/\"}],\"sidebar\":[{\"text\":\"Guide\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"link\":\"/en/guide/\"},{\"text\":\"Quick Start\",\"link\":\"/en/guide/quickstart/\"},{\"text\":\"Core Commands\",\"link\":\"/en/guide/core-commands/\"},{\"text\":\"Custom Commands\",\"link\":\"/en/guide/core-commands/\"},{\"text\":\"Configuration Management\",\"link\":\"/en/guide/config/\"},{\"text\":\"Hook Mechanism\",\"link\":\"/en/guide/hook/\"},{\"text\":\"Plugin Development\",\"link\":\"/en/guide/plugin/\"}]},{\"text\":\"Usage\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/en/usage/\"},{\"text\":\"Plugins\",\"link\":\"/en/usage/plugin/\"},{\"text\":\"Project Integration\",\"link\":\"/en/usage/integration/\"},{\"text\":\"Solutions\",\"link\":\"/en/usage/solution/\"},{\"text\":\"Distribution\",\"link\":\"/en/usage/distribution/\"}]},{\"text\":\"Community\",\"collapsed\":false,\"items\":[{\"text\":\"How to Contribute\",\"link\":\"/en/community/contrib/\"},{\"text\":\"Frequently Asked Questions\",\"link\":\"/en/community/qa/\"}]}]}}},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>